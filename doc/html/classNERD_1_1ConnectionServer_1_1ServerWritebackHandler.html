<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Network Rerouter Daemon (nerd): NERD::ConnectionServer::ServerWritebackHandler Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Network Rerouter Daemon (nerd)
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespaceNERD.html">NERD</a>      </li>
      <li class="navelem"><a class="el" href="classNERD_1_1ConnectionServer.html">ConnectionServer</a>      </li>
      <li class="navelem"><a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html">ServerWritebackHandler</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">NERD::ConnectionServer::ServerWritebackHandler Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="NERD::ConnectionServer::ServerWritebackHandler" -->
<p>Functor to handle SIGIO signals received through <a class="el" href="classLibWheel_1_1SignalQueue.html" title="A system for synchronously handling asynchronous signals in a uni-threaded process.">LibWheel::SignalQueue</a>.  
 <a href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#details">More...</a></p>

<p><a href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#ab92b47891071f80818d7bde25cae902c">ServerWritebackHandler</a> (<a class="el" href="classNERD_1_1ConnectionServer.html#ac838d247f33cef856ae722343a8cb7ff">PendingConnectionList</a> &amp;pcl, <a class="el" href="classNERD_1_1ConnectionServer.html#a1f7b6abdda0f0a7a027a5f2e24727cee">RedirectionTable</a> &amp;rt, <a class="el" href="classNERD_1_1ConnectionServer.html#a0cd661f2a6755c501ac198229675ad4d">ServerTable</a> &amp;st, <a class="el" href="classIPQ_1_1IpqSocket.html">IPQ::IpqSocket</a> &amp;s)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for <a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html" title="Functor to handle SIGIO signals received through LibWheel::SignalQueue.">ServerWritebackHandler</a>.  <a href="#ab92b47891071f80818d7bde25cae902c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#addc9ae778c4e9375c4499dab4eef2074">operator()</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Call operator for <a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html" title="Functor to handle SIGIO signals received through LibWheel::SignalQueue.">ServerWritebackHandler</a>.  <a href="#addc9ae778c4e9375c4499dab4eef2074"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNERD_1_1ConnectionServer.html#ac838d247f33cef856ae722343a8cb7ff">PendingConnectionList</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#ab13916995c4c8ed9debb0ebac0cca091">pendingConnections</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A reference to the containing ConnectionServer's list of pending connections.  <a href="#ab13916995c4c8ed9debb0ebac0cca091"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNERD_1_1ConnectionServer.html#a1f7b6abdda0f0a7a027a5f2e24727cee">RedirectionTable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#a436b00e74f3cab280212aea4c4068838">redirections</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A reference to the containing ConnectionServer's table of redirection rules.  <a href="#a436b00e74f3cab280212aea4c4068838"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNERD_1_1ConnectionServer.html#a0cd661f2a6755c501ac198229675ad4d">ServerTable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#aa08d6aaad29ae5ece57c9f0623803e06">servers</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A reference to the containing ConnectionServer's look-up table of active servers.  <a href="#aa08d6aaad29ae5ece57c9f0623803e06"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIPQ_1_1IpqSocket.html">IPQ::IpqSocket</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#a452352f53ba0bf33d1a4be562bd1f490">sock</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A handle to libipq.  <a href="#a452352f53ba0bf33d1a4be562bd1f490"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Functor to handle SIGIO signals received through <a class="el" href="classLibWheel_1_1SignalQueue.html" title="A system for synchronously handling asynchronous signals in a uni-threaded process.">LibWheel::SignalQueue</a>. </p>
<p>When a server process writes its listen port number to its stdout, that triggers a SIGIO; this functor determines which servers have called back and finishes setting up connections to them. See <a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#addc9ae778c4e9375c4499dab4eef2074" title="Call operator for ServerWritebackHandler.">operator()()</a> for details. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab92b47891071f80818d7bde25cae902c"></a><!-- doxytag: member="NERD::ConnectionServer::ServerWritebackHandler::ServerWritebackHandler" ref="ab92b47891071f80818d7bde25cae902c" args="(PendingConnectionList &amp;pcl, RedirectionTable &amp;rt, ServerTable &amp;st, IPQ::IpqSocket &amp;s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NERD::ConnectionServer::ServerWritebackHandler::ServerWritebackHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNERD_1_1ConnectionServer.html#ac838d247f33cef856ae722343a8cb7ff">PendingConnectionList</a> &amp;&#160;</td>
          <td class="paramname"><em>pcl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNERD_1_1ConnectionServer.html#a1f7b6abdda0f0a7a027a5f2e24727cee">RedirectionTable</a> &amp;&#160;</td>
          <td class="paramname"><em>rt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNERD_1_1ConnectionServer.html#a0cd661f2a6755c501ac198229675ad4d">ServerTable</a> &amp;&#160;</td>
          <td class="paramname"><em>st</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIPQ_1_1IpqSocket.html">IPQ::IpqSocket</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor for <a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html" title="Functor to handle SIGIO signals received through LibWheel::SignalQueue.">ServerWritebackHandler</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pcl</td><td>A reference to the containing ConnectionServer's list of pending connections. </td></tr>
    <tr><td class="paramname">rt</td><td>A reference to the containing ConnectionServer's look-up table of redirection rules. </td></tr>
    <tr><td class="paramname">st</td><td>A reference to the containing ConnectionServer's look-up table of active servers. </td></tr>
    <tr><td class="paramname">s</td><td>A handle to libipq. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="nerd_8cpp_source.html#l00809">809</a> of file <a class="el" href="nerd_8cpp_source.html">nerd.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="addc9ae778c4e9375c4499dab4eef2074"></a><!-- doxytag: member="NERD::ConnectionServer::ServerWritebackHandler::operator()" ref="addc9ae778c4e9375c4499dab4eef2074" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NERD::ConnectionServer::ServerWritebackHandler::operator() </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Call operator for <a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html" title="Functor to handle SIGIO signals received through LibWheel::SignalQueue.">ServerWritebackHandler</a>. </p>
<p>For all pending servers that have written data to stdout (the write ends of pipes whose read ends are held in the list of pending connections), read a port number, establish redirection rules for packet travelling to and from the server, add the server to the active servers table and remove it from the pending connections list, and forward the inital packet to the server. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>This is an O(n) operation in the number of pending connections. </dd></dl>
<dl class="user"><dt><b>Side Effects:</b></dt><dd>May write messages to <a class="el" href="namespaceLibWheel.html#af4ca70f4f65b2948701218436516a679" title="Global logmsg object.">LibWheel::logmsg</a>. </dd></dl>

<p>Definition at line <a class="el" href="nerd_8cpp_source.html#l00825">825</a> of file <a class="el" href="nerd_8cpp_source.html">nerd.cpp</a>.</p>

<p>References <a class="el" href="nerd_8cpp_source.html#l00282">NERD::ConnectionServer::pendingConnections</a>, <a class="el" href="WaitList__impl_8cpp_source.html#l00065">LibWheel::WaitList::begin()</a>, <a class="el" href="WaitList__impl_8cpp_source.html#l00090">LibWheel::WaitList::end()</a>, <a class="el" href="Signals_8cpp_source.html#l00525">LibWheel::uninterruptible_read()</a>, <a class="el" href="Logmsg_8hpp_source.html#l00047">LibWheel::logmsg</a>, <a class="el" href="logmsg_8h_source.html#l00072">logmsg_err</a>, <a class="el" href="WaitList__impl_8cpp_source.html#l00128">LibWheel::WaitList::erase()</a>, <a class="el" href="logmsg_8h_source.html#l00075">logmsg_info</a>, <a class="el" href="util_8cpp_source.html#l00037">LibWheel::ipv4_to_string()</a>, <a class="el" href="nerd_8cpp_source.html#l00048">LOCALHOST_IP</a>, <a class="el" href="nerd_8cpp_source.html#l00049">MAGIC_PORT</a>, <a class="el" href="nerd_8cpp_source.html#l00285">NERD::ConnectionServer::servers</a>, <a class="el" href="nerd_8cpp_source.html#l00283">NERD::ConnectionServer::redirections</a>, <a class="el" href="nerd_8cpp_source.html#l00279">NERD::ConnectionServer::sock</a>, and <a class="el" href="IPQ_8cpp_source.html#l00177">IPQ::IpqSocket::sendResponse()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ab13916995c4c8ed9debb0ebac0cca091"></a><!-- doxytag: member="NERD::ConnectionServer::ServerWritebackHandler::pendingConnections" ref="ab13916995c4c8ed9debb0ebac0cca091" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNERD_1_1ConnectionServer.html#ac838d247f33cef856ae722343a8cb7ff">PendingConnectionList</a>&amp; <a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#ab13916995c4c8ed9debb0ebac0cca091">NERD::ConnectionServer::ServerWritebackHandler::pendingConnections</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A reference to the containing ConnectionServer's list of pending connections. </p>

<p>Definition at line <a class="el" href="nerd_8cpp_source.html#l00263">263</a> of file <a class="el" href="nerd_8cpp_source.html">nerd.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a436b00e74f3cab280212aea4c4068838"></a><!-- doxytag: member="NERD::ConnectionServer::ServerWritebackHandler::redirections" ref="a436b00e74f3cab280212aea4c4068838" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNERD_1_1ConnectionServer.html#a1f7b6abdda0f0a7a027a5f2e24727cee">RedirectionTable</a>&amp; <a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#a436b00e74f3cab280212aea4c4068838">NERD::ConnectionServer::ServerWritebackHandler::redirections</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A reference to the containing ConnectionServer's table of redirection rules. </p>

<p>Definition at line <a class="el" href="nerd_8cpp_source.html#l00264">264</a> of file <a class="el" href="nerd_8cpp_source.html">nerd.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa08d6aaad29ae5ece57c9f0623803e06"></a><!-- doxytag: member="NERD::ConnectionServer::ServerWritebackHandler::servers" ref="aa08d6aaad29ae5ece57c9f0623803e06" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNERD_1_1ConnectionServer.html#a0cd661f2a6755c501ac198229675ad4d">ServerTable</a>&amp; <a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#aa08d6aaad29ae5ece57c9f0623803e06">NERD::ConnectionServer::ServerWritebackHandler::servers</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A reference to the containing ConnectionServer's look-up table of active servers. </p>

<p>Definition at line <a class="el" href="nerd_8cpp_source.html#l00265">265</a> of file <a class="el" href="nerd_8cpp_source.html">nerd.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a452352f53ba0bf33d1a4be562bd1f490"></a><!-- doxytag: member="NERD::ConnectionServer::ServerWritebackHandler::sock" ref="a452352f53ba0bf33d1a4be562bd1f490" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIPQ_1_1IpqSocket.html">IPQ::IpqSocket</a>&amp; <a class="el" href="classNERD_1_1ConnectionServer_1_1ServerWritebackHandler.html#a452352f53ba0bf33d1a4be562bd1f490">NERD::ConnectionServer::ServerWritebackHandler::sock</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>A handle to libipq. </p>

<p>Definition at line <a class="el" href="nerd_8cpp_source.html#l00266">266</a> of file <a class="el" href="nerd_8cpp_source.html">nerd.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="nerd_8cpp_source.html">nerd.cpp</a></li>
</ul>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 28 2012 13:00:09 for Network Rerouter Daemon (nerd) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5
</small></address>

</body>
</html>
